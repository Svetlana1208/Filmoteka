{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,S,aAGA,IAAIC,EA6BJ,SAASC,IACLH,EAAAI,KAAKC,UAAUC,UAAUC,IAAI,aAC7BC,SAASC,KAAKH,UAAUI,OAAO,mBAiB/BV,EAAAI,KAAKO,SAASC,UAAY,GAC1BZ,EAAAI,KAAKS,UAAUC,MAAQ,GACvBd,EAAAI,KAAKW,aAAaD,MAAQ,GAC1Bd,EAAAI,KAAKS,UAAUP,UAAUI,OAAO,SAChCV,EAAAI,KAAKW,aAAaT,UAAUI,OAAO,Q,CAjBvC,SAASM,EAAkBC,GACR,WAAXA,EAAEC,MACFf,G,CAIR,SAASgB,EAAoBF,GACrBA,EAAEG,gBAAkBH,EAAEI,QACtBlB,G,CAaN,SAASmB,EAAcL,GACrBA,EAAEM,iBACF,MAAOC,UAAUC,MAAEA,EAAKC,SAAEA,EAAQC,gBAAEA,IAAqBV,EAAEG,cAC3DlB,EAAO,CACHuB,MAAOA,EAAMX,MACbY,SAAUA,EAASZ,QAIvB,EAAAc,EAAAC,4BAA2B7B,EAAA8B,KAAM5B,EAAKuB,MAAOvB,EAAKwB,UACjDK,MAAMC,IACL,MACMC,EADOD,EAAeE,KACTT,MAAMU,MAAM,KAAK,GACpCnC,EAAAI,KAAKgC,UAAUxB,UAAY,GAAGqB,IAC9BjC,EAAAI,KAAK8B,KAAK5B,UAAUI,OAAO,aAC3BV,EAAAI,KAAKiC,cAAc/B,UAAUC,IAAI,aACjCP,EAAAI,KAAKkC,WAAWhC,UAAUI,OAAO,aACjCV,EAAAI,KAAKmC,YAAYC,iBAAiB,QAASC,GAC3CtC,GAAkB,IAEnBuC,OAAOC,IACN,MAAMC,EAAYD,EAAMzB,KACxB,MAAkB,wBAAd0B,GACF5C,EAAAI,KAAKS,UAAUP,UAAUC,IAAI,SACtBP,EAAAI,KAAKO,SAASC,UAAY,2BAGjB,wBAAdgC,GACF5C,EAAAI,KAAKW,aAAaT,UAAUC,IAAI,SACzBP,EAAAI,KAAKO,SAASC,UAAY,0BAGjB,0BAAdgC,GACF5C,EAAAI,KAAKW,aAAaT,UAAUC,IAAI,SACzBP,EAAAI,KAAKO,SAASC,UAAY,uBAFnC,C,IAON,SAAS6B,IACLI,QAAQC,IAAI,QACZ,EAAAlB,EAAAmB,UAAQ,EAAAnB,EAAAoB,YACRhD,EAAAI,KAAKiC,cAAc/B,UAAUI,OAAO,aACpCV,EAAAI,KAAKkC,WAAWhC,UAAUC,IAAI,aAC9BP,EAAAI,KAAK8B,KAAK5B,UAAUC,IAAI,Y,CAzF5BP,EAAAI,KAAK6C,iBAAiBT,iBAAiB,SATf,KACpBxC,EAAAI,KAAKC,UAAUC,UAAUI,OAAO,aAChCF,SAASC,KAAKH,UAAUC,IAAI,mBAC5BP,EAAAI,KAAK8C,kBAAkBV,iBAAiB,QAASrC,GACjDgD,OAAOX,iBAAiB,UAAWxB,GACnChB,EAAAI,KAAKC,UAAUmC,iBAAiB,QAASrB,GACzCnB,EAAAI,KAAKgD,SAASZ,iBAAiB,SAAUlB,EAAc,KAO3D,EAAAM,EAAAyB,oBAAmBrD,EAAA8B,MAAOwB,IACtB,GAAIA,EAAM,CACN,MAAMrB,EAAQqB,EAAK7B,MAAMU,MAAM,KAAK,GACpCU,QAAQC,IAAIb,GACZjC,EAAAI,KAAKgC,UAAUxB,UAAY,GAAGqB,IAC9BjC,EAAAI,KAAKmC,YAAYC,iBAAiB,QAASC,GAC3CzC,EAAAI,KAAKiC,cAAc/B,UAAUC,IAAI,aACjCP,EAAAI,KAAKkC,WAAWhC,UAAUI,OAAO,aACjCV,EAAAI,KAAK8B,KAAK5B,UAAUI,OAAO,Y,MAE3BmC,QAAQC,IAAI,4BAA4B","sources":["src/js/authorization.js"],"sourcesContent":["import {refs, auth} from \"./vars\";\nimport { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from \"firebase/auth\";\n\nlet user;\n\nconst onOpenAuthModal = () => {\n    refs.authModal.classList.remove(\"is-hidden\");\n    document.body.classList.add(\"body-modal-open\");\n    refs.authModalCloseBtn.addEventListener('click', onCloseAuthModal);\n    window.addEventListener('keydown', onEscKeyPressAuth);\n    refs.authModal.addEventListener('click', onBackdropClickAuth);\n    refs.authForm.addEventListener('submit', authorization);\n}\n\nrefs.authModalOpenBtn.addEventListener('click', onOpenAuthModal);\n\n\n\nonAuthStateChanged(auth, (user) => {\n    if (user) {\n        const login = user.email.split('@')[0];\n        console.log(login);\n        refs.userLogin.innerHTML = `${login}`;\n        refs.userSignOut.addEventListener('click', signOutUser);\n        refs.authorization.classList.add(\"is-hidden\");\n        refs.navigation.classList.remove(\"is-hidden\");\n        refs.user.classList.remove(\"is-hidden\");\n    } else {\n        console.log(\"user wasn't authorization\")\n    }\n});\n\nfunction onCloseAuthModal() {\n    refs.authModal.classList.add(\"is-hidden\");    \n    document.body.classList.remove(\"body-modal-open\");\n    currentTargetAuthReset();\n}\n\nfunction onEscKeyPressAuth(e) {\n    if (e.code === 'Escape') {\n        onCloseAuthModal();\n    }\n}\n\nfunction onBackdropClickAuth(e) {\n    if (e.currentTarget === e.target) {\n        onCloseAuthModal();\n    }\n}\n\nfunction currentTargetAuthReset() {\n    refs.authInfo.innerHTML = \"\";\n    refs.authEmail.value = \"\";\n    refs.authPassword.value = \"\";\n    refs.authEmail.classList.remove(\"error\");\n    refs.authPassword.classList.remove(\"error\");\n}\n\n\n  function authorization(e) {\n    e.preventDefault();\n    const {elements: { email, password, confirmPassword }} = e.currentTarget;\n    user = {\n        email: email.value,\n        password: password.value,\n    };\n\n\n    signInWithEmailAndPassword(auth, user.email, user.password)\n    .then((userCredential) => {\n      const user = userCredential.user;\n      const login = user.email.split('@')[0];\n      refs.userLogin.innerHTML = `${login}`;\n      refs.user.classList.remove(\"is-hidden\");\n      refs.authorization.classList.add(\"is-hidden\");\n      refs.navigation.classList.remove(\"is-hidden\");\n      refs.userSignOut.addEventListener('click', signOutUser);\n      onCloseAuthModal();\n    })\n    .catch((error) => {\n      const errorCode = error.code;\n      if (errorCode === \"auth/user-not-found\") {\n        refs.authEmail.classList.add(\"error\");\n        return refs.authInfo.innerHTML = \"Such user was not found\";\n      }\n\n      if (errorCode === \"auth/wrong-password\") {\n        refs.authPassword.classList.add(\"error\");\n        return refs.authInfo.innerHTML = \"Enter correct password\";\n      }\n\n      if (errorCode === \"auth/missing-password\") {\n        refs.authPassword.classList.add(\"error\");\n        return refs.authInfo.innerHTML = \"Enter password\";\n      }\n    });\n}\n\nfunction signOutUser() {\n    console.log(\"out\");\n    signOut(getAuth());\n    refs.authorization.classList.remove(\"is-hidden\");\n    refs.navigation.classList.add(\"is-hidden\");\n    refs.user.classList.add(\"is-hidden\");\n}\n\n"],"names":["$hWKZL","parcelRequire","$926669d2b7398d15$var$user","$926669d2b7398d15$var$onCloseAuthModal","refs","authModal","classList","add","document","body","remove","authInfo","innerHTML","authEmail","value","authPassword","$926669d2b7398d15$var$onEscKeyPressAuth","e","code","$926669d2b7398d15$var$onBackdropClickAuth","currentTarget","target","$926669d2b7398d15$var$authorization","preventDefault","elements","email","password","confirmPassword","$eyjy7","signInWithEmailAndPassword","auth","then","userCredential","login","user","split","userLogin","authorization","navigation","userSignOut","addEventListener","$926669d2b7398d15$var$signOutUser","catch","error","errorCode","console","log","signOut","getAuth","authModalOpenBtn","authModalCloseBtn","window","authForm","onAuthStateChanged","user1"],"version":3,"file":"index.e249aec9.js.map"}